!function(){"use strict";fetch("https://around.nomoreparties.co/v1/web_es_07/cards",{headers:{authorization:"d73ff8a4-5ad7-42cb-999c-d084ca2e6847"}}).then((e=>e.ok?e.json():Promise.reject(e.status))).then((e=>{console.log(e),console.log("todo ok")}));const e=document.querySelector(".edit-button"),t=(document.querySelector(".form__submit-button"),document.querySelector(".form__close-button"),document.querySelector(".popup_type_edit-profile")),o=document.querySelector(".profile__user-name"),r=document.querySelector(".profile__user-profession"),s=document.querySelector(".profile__avatar"),n=(document.querySelector("#name-input"),document.querySelector("#about-me-input"),document.querySelector(".add-button")),a=(document.querySelector(".form__close-button_type_new-place"),document.querySelector(".popup_type_new-place")),c=document.querySelector(".form__submit-button_place"),i=(document.querySelector(".card-container"),document.querySelector(".popup_type_photo")),l=document.querySelector(".popup__photo"),u=document.querySelector(".popup__photo-caption"),p=document.querySelector(".popup__close-button");class m{constructor({items:e,renderer:t},o){this._itemsArray=e,this._renderer=t,this._container=o}addItem(e){this._container.append(e)}renderItems(){this._itemsArray.forEach((e=>{this._renderer(e)}))}test(){console.log(this._itemsArray)}}const _=/^[A-Za-z\-]{2,100}$/,d=/^[A-Za-z\-]{2,20}$/,h=/^[A-Za-z\-]{4,20}$/,S=/^[A-Za-z\-]{4,500}$/;class f{constructor(e){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}switchingInput(e){switch(e.target.name){case"name":this._checkInputValidity(_,e.target,this._formSelector);break;case" aboutMe":this._checkInputValidity(d,e.target,this._formSelector);break;case"placeName":this._checkInputValidity(h,e.target,this._formSelector);break;case"link":this._checkInputValidity(S,e.target,this._formSelector)}}_checkInputValidity(e,t,o){const r=document.getElementById(o).querySelector(`.${t.id}-error`);e.test(t.value)?(r.classList.remove(this._errorClass),r.textContent="",t.classList.remove(this._inputErrorClass)):(r.textContent=t.validationMessage,r.classList.add(this._errorClass),t.classList.add(this._inputErrorClass))}isValid(e){let t="";const o=document.getElementById(e);return t=!!Array.from(o.querySelectorAll(this._inputSelector)).every((e=>e.validity.valid)),t}toggleBtnState(e){const t=document.getElementById(e).querySelector(this._submitButtonSelector);!0===this.isValid(e)?t.classList.remove(this._inactiveButtonClass):t.classList.add(this._inactiveButtonClass)}enableValidation(){const e=document.getElementById(this._formSelector),t=Array.from(e.querySelectorAll(this._inputSelector));this.toggleBtnState(this._formSelector),t.forEach((e=>{e.addEventListener("input",(e=>{this.switchingInput(e),this.toggleBtnState(this._formSelector)}))}))}test(){const e=document.getElementById(this._formSelector).querySelector(`.${evt.target.id}-error`);console.log(e)}}const y=document.querySelector(".card-container");class b{constructor({data:e,photoHandler:t},o){this._name=e.placeName,this._link=e.link,this._templateSelector=o,this._photoHandler=t}getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".place-card").cloneNode(!0)}generateCard(){this._cardElement=this.getTemplate(),this._cardElement.querySelector(".place-card__name").textContent=this._name,this._cardElement.querySelector(".place-card__photo").src=this._link,this._setEventListeners();const e=this._cardElement.querySelector(".trash-button");return e.addEventListener("click",(()=>{e.closest(".place-card").remove()})),this._cardElement.querySelector(".like-button").addEventListener("click",(function(e){e.target.classList.toggle("like-button_active")})),this._cardElement}_handleOpenPopup(){this._photoHandler(this._link,this._name)}_handleClosePopup(){l.src=" ",u.textContent=" ",i.classList.remove("popup_opened")}_setEventListeners(){this._cardElement.querySelector(".place-card__photo").addEventListener("click",(()=>{this._handleOpenPopup()})),p.addEventListener("click",(()=>{this._handleClosePopup()}))}test(){this.generateCard()}}class v{constructor(e){this._popup=e,this._form=e.querySelector(".form")}open(){this._popup.classList.add("popup_opened")}close(){this._popup.classList.remove("popup_opened")}_handleEscClose(){document.addEventListener("keydown",(e=>{e.preventDefault,"Escape"===e.key&&this.close()}))}setEventListeners(e){e.addEventListener("click",(()=>{this.open()})),this._handleEscClose(),this._form.querySelector(".form__close-button").addEventListener("click",(e=>{e.preventDefault(),this.close()}))}}class E extends v{constructor(e){super(e)}open(e,t){super.open(),this._photo=document.querySelector(".popup__photo").src=e,this._caption=document.querySelector(".popup__photo-caption").textContent=t}test(){console.log("desde test de popimage")}}class g extends v{constructor({formSubmitHandler:e},t){super(t),this._formSubmitHandler=e,this._form=this._popup.querySelector(".form")}close(){super.close(),"place"==this._form.id&&this._form.reset(),this._popup.querySelector(".overlay").addEventListener("click",(e=>{this._popup.classList.remove("popup_opened"),e.stopImmediatePropagation()}))}getInputValues(){this._inputList=this._form.querySelectorAll(".form__input");const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(e){this.getInputValues(),super.setEventListeners(e),this._form.addEventListener("submit",(e=>{e.preventDefault(),e.stopImmediatePropagation(),this._formSubmitHandler(this.getInputValues()),this.close(),document.forms.place.reset()}))}}class k{constructor({data:e}){this._userName=e.name,this._userAboutMe=e["about-me"]}getUserInfo(){this._userName=o.textContent,this._userAboutMe=r.textContent}setUserInfo(){o.textContent=this._userName,r.textContent=this._userAboutMe}}new f({formSelector:"profile",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"}).enableValidation(),new f({formSelector:"place",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"}).enableValidation();const C=new m({items:[{placeName:"Valle de Yosemite",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/yosemite.jpg"},{placeName:"Lago Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lake-louise.jpg"},{placeName:"MontaÃ±as Calvas",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/bald-mountains.jpg"},{placeName:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/latemar.jpg"},{placeName:"Parque Nacional de la Vanoise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/vanoise.jpg"},{placeName:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lago.jpg"}],renderer:e=>{const t=new b({data:e,photoHandler:(e,t)=>{new E(i).open(e,t)}},"#card-template").generateCard();C.addItem(t)}},y);C.renderItems(),new g({formSubmitHandler:e=>{const t=new k({data:e});t.setUserInfo(),t.getUserInfo()}},t).setEventListeners(e),new g({formSubmitHandler:e=>{const t=e,o=[];o.push(t),c.classList.add("form__submit-button_inactive");const r=new m({items:o,renderer:e=>{const t=new b({data:e,photoHandler:(e,t)=>{new E(i).open(e,t)}},"#card-template").generateCard();r.addItem(t)}},y);r.renderItems()}},a).setEventListeners(n,".form__submit-button_place"),fetch("https://around.nomoreparties.co/v1/web_es_07/users/me ",{headers:{authorization:"d73ff8a4-5ad7-42cb-999c-d084ca2e6847"}}).then((e=>e.ok?e.json():Promise.reject(e.status))).then((e=>{var t;t=e,o.textContent=t.name,r.textContent=t.about,s.src=t.avatar,console.log(e)})).then((e=>{o.textContent=e.name,r.textContent=e.about,s.src=e.avatar})).catch((e=>{console.log(`Error: ${e}`)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQUFBLE1BQU0scURBQXNELENBQzFEQyxRQUFTLENBQ1BDLGNBQWUsMENBR2hCQyxNQUFNQyxHQUNEQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFPSixFQUFJSyxVQUUzQk4sTUFBTUMsSUFDTE0sUUFBUUMsSUFBSVAsR0FDWk0sUUFBUUMsSUFBSSxVQUFaLElBR0csTUEyQk1DLEVBQWlCQyxTQUFTQyxjQUFjLGdCQUt4Q0MsR0FKbUJGLFNBQVNDLGNBQWMsd0JBQ3BCRCxTQUFTQyxjQUMxQyx1QkFFOEJELFNBQVNDLGNBQ3ZDLDZCQUVXRSxFQUFXSCxTQUFTQyxjQUFjLHVCQUNsQ0csRUFBY0osU0FBU0MsY0FBYyw2QkFDckNJLEVBQWFMLFNBQVNDLGNBQWMsb0JBR3BDSyxHQUZnQk4sU0FBU0MsY0FBYyxlQUNqQkQsU0FBU0MsY0FBYyxtQkFDNUJELFNBQVNDLGNBQWMsZ0JBSXhDTSxHQUhtQlAsU0FBU0MsY0FDdkMsc0NBRThCRCxTQUFTQyxjQUFjLDBCQUMxQ08sRUFBb0JSLFNBQVNDLGNBQ3hDLDhCQUlXUSxHQURpQlQsU0FBU0MsY0FBYyxtQkFDM0JELFNBQVNDLGNBQWMsc0JBR3BDUyxFQUFZVixTQUFTQyxjQUFjLGlCQUNuQ1UsRUFBZVgsU0FBU0MsY0FBYyx5QkFDdENXLEVBQWdCWixTQUFTQyxjQUFjLHdCQ3ZFckMsTUFBTVksRUFDbkJDLGFBQVksTUFBRUMsRUFBRixTQUFTQyxHQUFZQyxHQUMvQkMsS0FBS0MsWUFBY0osRUFDbkJHLEtBQUtFLFVBQVlKLEVBQ2pCRSxLQUFLRyxXQUFhSixDQUNuQixDQUNESyxRQUFRQyxHQUNOTCxLQUFLRyxXQUFXRyxPQUFPRCxFQUN4QixDQUNERSxjQUNFUCxLQUFLQyxZQUFZTyxTQUFTSCxJQUN4QkwsS0FBS0UsVUFBVUcsRUFBZixHQUVILENBQ0RJLE9BQ0U5QixRQUFRQyxJQUFJb0IsS0FBS0MsWUFDbEIsRUNoQkgsTUFBTVMsRUFDRSxzQkFERkEsRUFFSyxxQkFGTEEsRUFHTyxxQkFIUEEsRUFJRSxzQkFHRCxNQUFNQyxFQUNYZixZQUFZZ0IsR0FDVlosS0FBS2EsY0FBZ0JELEVBQWNFLGFBQ25DZCxLQUFLZSxlQUFpQkgsRUFBY0ksY0FDcENoQixLQUFLaUIsc0JBQXdCTCxFQUFjTSxxQkFDM0NsQixLQUFLbUIscUJBQXVCUCxFQUFjUSxvQkFDMUNwQixLQUFLcUIsaUJBQW1CVCxFQUFjVSxnQkFDdEN0QixLQUFLdUIsWUFBY1gsRUFBY1ksVUFDbEMsQ0FFREMsZUFBZUMsR0FDYixPQUFRQSxFQUFJQyxPQUFPQyxNQUNqQixJQUFLLE9BQ0g1QixLQUFLNkIsb0JBQW9CbkIsRUFBWWdCLEVBQUlDLE9BQVEzQixLQUFLYSxlQUV0RCxNQUNGLElBQUssV0FDSGIsS0FBSzZCLG9CQUFvQm5CLEVBQWVnQixFQUFJQyxPQUFRM0IsS0FBS2EsZUFFekQsTUFDRixJQUFLLFlBQ0hiLEtBQUs2QixvQkFDSG5CLEVBQ0FnQixFQUFJQyxPQUNKM0IsS0FBS2EsZUFHUCxNQUNGLElBQUssT0FDSGIsS0FBSzZCLG9CQUFvQm5CLEVBQVlnQixFQUFJQyxPQUFRM0IsS0FBS2EsZUFJM0QsQ0FDRGdCLG9CQUFvQkMsRUFBV0MsRUFBY0MsR0FDM0MsTUFDTUMsRUFEY25ELFNBQVNvRCxlQUFlRixHQUNYakQsY0FBZSxJQUFHZ0QsRUFBYUksWUFFNURMLEVBQVVyQixLQUFLc0IsRUFBYUssUUFDOUJILEVBQWFJLFVBQVVDLE9BQU90QyxLQUFLdUIsYUFFbkNVLEVBQWFNLFlBQWMsR0FDM0JSLEVBQWFNLFVBQVVDLE9BQU90QyxLQUFLcUIsb0JBRW5DWSxFQUFhTSxZQUFjUixFQUFhUyxrQkFDeENQLEVBQWFJLFVBQVVJLElBQUl6QyxLQUFLdUIsYUFDaENRLEVBQWFNLFVBQVVJLElBQUl6QyxLQUFLcUIsa0JBRW5DLENBSURxQixRQUFRVixHQUNOLElBQUlXLEVBQVEsR0FDWixNQUFNQyxFQUFjOUQsU0FBU29ELGVBQWVGLEdBYzVDLE9BSkVXLElBVGlCRSxNQUFNQyxLQUN2QkYsRUFBWUcsaUJBQWlCL0MsS0FBS2UsaUJBSXZCaUMsT0FBT2pCLEdBQ1RBLEVBQWFrQixTQUFTTixRQU8xQkEsQ0FDUixDQUdETyxlQUFlbEIsR0FDYixNQUNNbUIsRUFEY3JFLFNBQVNvRCxlQUFlRixHQUNiakQsY0FBY2lCLEtBQUtpQix3QkFFckIsSUFBekJqQixLQUFLMEMsUUFBUVYsR0FDZm1CLEVBQVdkLFVBQVVDLE9BQU90QyxLQUFLbUIsc0JBRWpDZ0MsRUFBV2QsVUFBVUksSUFBSXpDLEtBQUttQixxQkFFakMsQ0FHRGlDLG1CQUNFLE1BQU1SLEVBQWM5RCxTQUFTb0QsZUFBZWxDLEtBQUthLGVBRTNDd0MsRUFBYVIsTUFBTUMsS0FDdkJGLEVBQVlHLGlCQUFpQi9DLEtBQUtlLGlCQUVwQ2YsS0FBS2tELGVBQWVsRCxLQUFLYSxlQUN6QndDLEVBQVc3QyxTQUFTOEMsSUFDbEJBLEVBQU1DLGlCQUFpQixTQUFVN0IsSUFDL0IxQixLQUFLeUIsZUFBZUMsR0FDcEIxQixLQUFLa0QsZUFBZWxELEtBQUthLGNBQXpCLEdBRkYsR0FLSCxDQUVESixPQUNFLE1BRU13QixFQUZjbkQsU0FBU29ELGVBQWVsQyxLQUFLYSxlQUVoQjlCLGNBQWUsSUFBRzJDLElBQUlDLE9BQU9RLFlBQzlEeEQsUUFBUUMsSUFBSXFELEVBQ2IsRUN2R0ksTUFBTXVCLEVBQWlCMUUsU0FBU0MsY0FBYyxtQkFFOUMsTUFBTTBFLEVBQ1g3RCxhQUFZLEtBQUU4RCxFQUFGLGFBQVFDLEdBQWdCQyxHQUNsQzVELEtBQUs2RCxNQUFRSCxFQUFLSSxVQUNsQjlELEtBQUsrRCxNQUFRTCxFQUFLTSxLQUNsQmhFLEtBQUtpRSxrQkFBb0JMLEVBQ3pCNUQsS0FBS2tFLGNBQWdCUCxDQUN0QixDQUNEUSxjQUtFLE9BSnFCckYsU0FBU0MsY0FBY2lCLEtBQUtpRSxtQkFBbUJHLFFBRWpFckYsY0FBYyxlQUNkc0YsV0FBVSxFQUVkLENBQ0RDLGVBQ0V0RSxLQUFLdUUsYUFBZXZFLEtBQUttRSxjQUN6Qm5FLEtBQUt1RSxhQUFheEYsY0FBYyxxQkFBcUJ3RCxZQUNuRHZDLEtBQUs2RCxNQUNQN0QsS0FBS3VFLGFBQWF4RixjQUFjLHNCQUFzQnlGLElBQU14RSxLQUFLK0QsTUFDakUvRCxLQUFLeUUscUJBRUwsTUFBTUMsRUFBVzFFLEtBQUt1RSxhQUFheEYsY0FBYyxpQkFVakQsT0FUQTJGLEVBQVNuQixpQkFBaUIsU0FBUyxLQUNabUIsRUFBU0MsUUFBUSxlQUN6QnJDLFFBQWIsSUFFZXRDLEtBQUt1RSxhQUFheEYsY0FBYyxnQkFDeEN3RSxpQkFBaUIsU0FBUyxTQUFVN0IsR0FDM0NBLEVBQUlDLE9BQU9VLFVBQVV1QyxPQUFPLHFCQUM3QixJQUVNNUUsS0FBS3VFLFlBQ2IsQ0FFRE0sbUJBQ0U3RSxLQUFLa0UsY0FBY2xFLEtBQUsrRCxNQUFPL0QsS0FBSzZELE1BQ3JDLENBRURpQixvQkFDRXRGLEVBQVVnRixJQUFNLElBQ2hCL0UsRUFBYThDLFlBQWMsSUFDM0JoRCxFQUFXOEMsVUFBVUMsT0FBTyxlQUM3QixDQUVEbUMscUJBQ0V6RSxLQUFLdUUsYUFDRnhGLGNBQWMsc0JBQ2R3RSxpQkFBaUIsU0FBUyxLQUN6QnZELEtBQUs2RSxrQkFBTCxJQUVKbkYsRUFBYzZELGlCQUFpQixTQUFTLEtBQ3RDdkQsS0FBSzhFLG1CQUFMLEdBRUgsQ0FDRHJFLE9BQ0VULEtBQUtzRSxjQUNOLEVDbEVZLE1BQU1TLEVBQ25CbkYsWUFBWW9GLEdBQ1ZoRixLQUFLaUYsT0FBU0QsRUFDZGhGLEtBQUtrRixNQUFRRixFQUFNakcsY0FBYyxRQUNsQyxDQUNEb0csT0FDRW5GLEtBQUtpRixPQUFPNUMsVUFBVUksSUFBSSxlQUMzQixDQUNEMkMsUUFDRXBGLEtBQUtpRixPQUFPNUMsVUFBVUMsT0FBTyxlQUM5QixDQUNEK0Msa0JBQ0V2RyxTQUFTeUUsaUJBQWlCLFdBQVk3QixJQUNwQ0EsRUFBSTRELGVBQ1ksV0FBWjVELEVBQUk2RCxLQUNOdkYsS0FBS29GLE9BQ04sR0FFSixDQUNESSxrQkFBa0JDLEdBQ2hCQSxFQUFXbEMsaUJBQWlCLFNBQVMsS0FDbkN2RCxLQUFLbUYsTUFBTCxJQUVGbkYsS0FBS3FGLGtCQUNMckYsS0FBS2tGLE1BQ0ZuRyxjQUFjLHVCQUNkd0UsaUJBQWlCLFNBQVU3QixJQUMxQkEsRUFBSTRELGlCQUNKdEYsS0FBS29GLE9BQUwsR0FFTCxFQzVCWSxNQUFNTSxVQUF1QlgsRUFDMUNuRixZQUFZb0YsR0FDVlcsTUFBTVgsRUFDUCxDQUNERyxLQUFLWCxFQUFLNUMsR0FDUitELE1BQU1SLE9BQ05uRixLQUFLNEYsT0FBUzlHLFNBQVNDLGNBQWMsaUJBQWlCeUYsSUFBTUEsRUFFNUR4RSxLQUFLNkYsU0FBVy9HLFNBQVNDLGNBQ3ZCLHlCQUNBd0QsWUFBY1gsQ0FDakIsQ0FDRG5CLE9BQ0U5QixRQUFRQyxJQUFJLHlCQUNiLEVDZlksTUFBTWtILFVBQXNCZixFQUN6Q25GLGFBQVksa0JBQUVtRyxHQUFxQmYsR0FDakNXLE1BQU1YLEdBQ05oRixLQUFLZ0csbUJBQXFCRCxFQUMxQi9GLEtBQUtrRixNQUFRbEYsS0FBS2lGLE9BQU9sRyxjQUFjLFFBQ3hDLENBRURxRyxRQUNFTyxNQUFNUCxRQUNlLFNBQWpCcEYsS0FBS2tGLE1BQU0vQyxJQUNibkMsS0FBS2tGLE1BQU1lLFFBRWJqRyxLQUFLaUYsT0FBT2xHLGNBQWMsWUFBWXdFLGlCQUFpQixTQUFVN0IsSUFDL0QxQixLQUFLaUYsT0FBTzVDLFVBQVVDLE9BQU8sZ0JBQzdCWixFQUFJd0UsMEJBQUosR0FFSCxDQUNEQyxpQkFDRW5HLEtBQUtvRyxXQUFhcEcsS0FBS2tGLE1BQU1uQyxpQkFBaUIsZ0JBQzlDLE1BQU1zRCxFQUFhLENBQUMsRUFJcEIsT0FIQXJHLEtBQUtvRyxXQUFXNUYsU0FBUzhDLElBQ3ZCK0MsRUFBVy9DLEVBQU0xQixNQUFRMEIsRUFBTWxCLEtBQS9CLElBRUtpRSxDQUNSLENBRURiLGtCQUFrQkMsR0FDaEJ6RixLQUFLbUcsaUJBQ0xSLE1BQU1ILGtCQUFrQkMsR0FFeEJ6RixLQUFLa0YsTUFBTTNCLGlCQUFpQixVQUFXN0IsSUFDckNBLEVBQUk0RCxpQkFDSjVELEVBQUl3RSwyQkFDSmxHLEtBQUtnRyxtQkFBbUJoRyxLQUFLbUcsa0JBQzdCbkcsS0FBS29GLFFBQ0x0RyxTQUFTd0gsTUFBTUMsTUFBTU4sT0FBckIsR0FFSCxFQ3JDWSxNQUFNTyxFQUNuQjVHLGFBQVksS0FBRThELElBQ1oxRCxLQUFLeUcsVUFBWS9DLEVBQUs5QixLQUN0QjVCLEtBQUswRyxhQUFlaEQsRUFBSyxXQUMxQixDQUNEaUQsY0FDRTNHLEtBQUt5RyxVQUFZeEgsRUFBU3NELFlBQzFCdkMsS0FBSzBHLGFBQWV4SCxFQUFZcUQsV0FDakMsQ0FFRHFFLGNBQ0UzSCxFQUFTc0QsWUFBY3ZDLEtBQUt5RyxVQUM1QnZILEVBQVlxRCxZQUFjdkMsS0FBSzBHLFlBQ2hDLEVDMEJ1QixJQUFJL0YsRUFsQkwsQ0FDdkJHLGFBQWMsVUFDZEUsY0FBZSxlQUNmRSxxQkFBc0IsdUJBQ3RCRSxvQkFBcUIsK0JBQ3JCRSxnQkFBaUIseUJBQ2pCRSxXQUFZLDZCQWFpQjRCLG1CQUVQLElBQUl6QyxFQVpGLENBQ3hCRyxhQUFjLFFBQ2RFLGNBQWUsZUFDZkUscUJBQXNCLHVCQUN0QkUsb0JBQXFCLCtCQUNyQkUsZ0JBQWlCLHlCQUNqQkUsV0FBWSw2QkFPZ0I0QixtQkF0QjlCLE1BMEJNeUQsRUFBa0IsSUFBSWxILEVBQzFCLENBQ0VFLE1SbEN3QixDQUMxQixDQUNFaUUsVUFBVyxvQkFDWEUsS0FBTSxpR0FFUixDQUNFRixVQUFXLGNBQ1hFLEtBQU0sb0dBRVIsQ0FDRUYsVUFBVyxrQkFDWEUsS0FBTSx1R0FFUixDQUNFRixVQUFXLFVBQ1hFLEtBQU0sZ0dBRVIsQ0FDRUYsVUFBVyxnQ0FDWEUsS0FBTSxnR0FFUixDQUNFRixVQUFXLGlCQUNYRSxLQUFNLDhGUVlObEUsU0FBV08sSUFDVCxNQVVNeUcsRUFWTyxJQUFJckQsRUFDZixDQUNFQyxLQUFNckQsRUFDTnNELGFBQWMsQ0FBQ2EsRUFBSzVDLEtBQ0osSUFBSThELEVBQWVuRyxHQUNWNEYsS0FBS1gsRUFBSzVDLEVBQWpDLEdBR0osa0JBRW1CMEMsZUFDckJ1QyxFQUFnQnpHLFFBQVEwRyxFQUF4QixHQUdKdEQsR0FFRnFELEVBQWdCdEcsY0FHUyxJQUFJdUYsRUFDM0IsQ0FDRUMsa0JBQW9CckMsSUFHbEIsTUFBTXFELEVBQU8sSUFBSVAsRUFBUyxDQUFFOUMsS0FBTUEsSUFDbEJxRCxFQUFLSCxjQUNIRyxFQUFLSixhQUF2QixHQUdKM0gsR0FFb0N3RyxrQkFBa0IzRyxHQUdqQyxJQUFJaUgsRUFDekIsQ0FDRUMsa0JBQW9CckMsSUFDbEIsTUFBTXNELEVBQVV0RCxFQUVWdUQsRUFBZ0IsR0FFdEJBLEVBQWNDLEtBQUtGLEdBQ25CMUgsRUFBa0IrQyxVQUFVSSxJQUFJLGdDQUNoQyxNQUFNMEUsRUFBZSxJQUFJeEgsRUFDdkIsQ0FDRUUsTUFBT29ILEVBQ1BuSCxTQUFXNEQsSUFDVCxNQVVNb0QsRUFWWSxJQUFJckQsRUFDcEIsQ0FDRUMsS0FBTUEsRUFDTkMsYUFBYyxDQUFDYSxFQUFLNUMsS0FDSixJQUFJOEQsRUFBZW5HLEdBQ1Y0RixLQUFLWCxFQUFLNUMsRUFBakMsR0FHSixrQkFFd0IwQyxlQUMxQjZDLEVBQWEvRyxRQUFRMEcsRUFBckIsR0FHSnRELEdBRUYyRCxFQUFhNUcsYUFBYixHQUdKbEIsR0FFYW1HLGtCQUFrQnBHLEVBQWdCLDhCQVVqRG5CLE1BQU0seURBQTBELENBQzlEQyxRQUFTLENBQ1BDLGNBQWUsMENBR2hCQyxNQUFNQyxHQUNEQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUVOQyxRQUFRQyxPQUFPSixFQUFJSyxVQUUzQk4sTUFBTUMsSUFqQlQsSUFBdUIrSSxJQWtCTC9JLEVBakJoQlksRUFBU3NELFlBQWM2RSxFQUFTeEYsS0FDaEMxQyxFQUFZcUQsWUFBYzZFLEVBQVNDLE1BQ25DbEksRUFBV3FGLElBQU00QyxFQUFTRSxPQWdCeEIzSSxRQUFRQyxJQUFJUCxFQUFaLElBRURELE1BQU1DLElBQ0xZLEVBQVNzRCxZQUFjbEUsRUFBSXVELEtBQzNCMUMsRUFBWXFELFlBQWNsRSxFQUFJZ0osTUFDOUJsSSxFQUFXcUYsSUFBTW5HLEVBQUlpSixNQUFyQixJQUVEQyxPQUFPQyxJQUNON0ksUUFBUUMsSUFBSyxVQUFTNEksSUFBdEIsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdC91dGlscy9EYXRhLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdC9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0L2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9zY3JpcHQvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdC9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdC9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdC9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0L2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL3dlYl9lc18wNy9jYXJkc1wiLCB7XHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJkNzNmZjhhNC01YWQ3LTQyY2ItOTk5Yy1kMDg0Y2EyZTY4NDdcIixcclxuICB9LFxyXG59KVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QocmVzLnN0YXR1cyk7XHJcbiAgfSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhyZXMpO1xyXG4gICAgY29uc29sZS5sb2coXCJ0b2RvIG9rXCIpO1xyXG4gIH0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBwbGFjZU5hbWU6IFwiVmFsbGUgZGUgWW9zZW1pdGVcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBwbGFjZU5hbWU6IFwiTGFnbyBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBwbGFjZU5hbWU6IFwiTW9udGHDsWFzIENhbHZhc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHBsYWNlTmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBwbGFjZU5hbWU6IFwiUGFycXVlIE5hY2lvbmFsIGRlIGxhIFZhbm9pc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHBsYWNlTmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcbi8vY29uc3RhbnRlcyB1bml2ZXJzYWxlc1xyXG5leHBvcnQgY29uc3QgYnRuRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYnRuQ3JlYXRlUHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGJ0bkNsb3NlRWRpdFByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX2Nsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wb3B1cF90eXBlX2VkaXQtcHJvZmlsZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCB1c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdXNlci1uYW1lXCIpO1xyXG5leHBvcnQgY29uc3QgdXNlckFib3V0TWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3VzZXItcHJvZmVzc2lvblwiKTtcclxuZXhwb3J0IGNvbnN0IHVzZXJBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuZXhwb3J0IGNvbnN0IHVzZXJOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWUtaW5wdXRcIik7XHJcbmV4cG9ydCBjb25zdCB1c2VyUHJvZmVzc2lvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhYm91dC1tZS1pbnB1dFwiKTtcclxuZXhwb3J0IGNvbnN0IGJ0bkFkZE5ld1BsYWNlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgYnRuQ2xvc2VOZXdQbGFjZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuZm9ybV9fY2xvc2UtYnV0dG9uX3R5cGVfbmV3LXBsYWNlXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkTmV3UGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfbmV3LXBsYWNlXCIpO1xyXG5leHBvcnQgY29uc3QgYnRuU3VibWl0TmV3UGxhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLmZvcm1fX3N1Ym1pdC1idXR0b25fcGxhY2VcIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkLWNvbnRhaW5lclwiKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwUGhvdG8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX3R5cGVfcGhvdG9cIik7XHJcblxyXG4vL3BvcHVwIHBob3RvXHJcbmV4cG9ydCBjb25zdCBsaW5rUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19waG90b1wiKTtcclxuZXhwb3J0IGNvbnN0IGNhcHRpb25Qb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3Bob3RvLWNhcHRpb25cIik7XHJcbmV4cG9ydCBjb25zdCBidG5DbG9zZVBob3RvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY2xvc2UtYnV0dG9uXCIpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXNBcnJheSA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lclNlbGVjdG9yO1xyXG4gIH1cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoaXRlbSk7XHJcbiAgfVxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXNBcnJheS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHRlc3QoKSB7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9pdGVtc0FycmF5KTtcclxuICB9XHJcbn1cclxuIiwiY29uc3QgcmVnRXggPSB7XHJcbiAgbmFtZTogL15bQS1aYS16XFwtXXsyLDEwMH0kLyxcclxuICBhYm91dE1lOiAvXltBLVphLXpcXC1dezIsMjB9JC8sXHJcbiAgcGxhY2VOYW1lOiAvXltBLVphLXpcXC1dezQsMjB9JC8sXHJcbiAgbGluazogL15bQS1aYS16XFwtXXs0LDUwMH0kLyxcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvYmpUb1ZhbGlkYXRlKSB7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBvYmpUb1ZhbGlkYXRlLmZvcm1TZWxlY3RvcjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBvYmpUb1ZhbGlkYXRlLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IG9ialRvVmFsaWRhdGUuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gb2JqVG9WYWxpZGF0ZS5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gb2JqVG9WYWxpZGF0ZS5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gb2JqVG9WYWxpZGF0ZS5lcnJvckNsYXNzO1xyXG4gIH1cclxuICAvL3Rlcm1pbmEgZWwgY29uc3RydWN0b3JcclxuICBzd2l0Y2hpbmdJbnB1dChldnQpIHtcclxuICAgIHN3aXRjaCAoZXZ0LnRhcmdldC5uYW1lKSB7XHJcbiAgICAgIGNhc2UgXCJuYW1lXCI6XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KHJlZ0V4Lm5hbWUsIGV2dC50YXJnZXQsIHRoaXMuX2Zvcm1TZWxlY3Rvcik7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZXJyb3JFbGVtZW50KTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIiBhYm91dE1lXCI6XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KHJlZ0V4LmFib3V0TWUsIGV2dC50YXJnZXQsIHRoaXMuX2Zvcm1TZWxlY3Rvcik7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coZXJyb3JFbGVtZW50KTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcInBsYWNlTmFtZVwiOlxyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShcclxuICAgICAgICAgIHJlZ0V4LnBsYWNlTmFtZSxcclxuICAgICAgICAgIGV2dC50YXJnZXQsXHJcbiAgICAgICAgICB0aGlzLl9mb3JtU2VsZWN0b3JcclxuICAgICAgICApO1xyXG4gICAgICAgIC8vY29uc29sZS5sb2coZXJyb3JFbGVtZW50KTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcImxpbmtcIjpcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkocmVnRXgubGluaywgZXZ0LnRhcmdldCwgdGhpcy5fZm9ybVNlbGVjdG9yKTtcclxuXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoZXhwcmVzaW9uLCBpbnB1dEVsZW1lbnQsIGZvcm1JRCkge1xyXG4gICAgY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtSUQpO1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG5cclxuICAgIGlmIChleHByZXNpb24udGVzdChpbnB1dEVsZW1lbnQudmFsdWUpKSB7XHJcbiAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG5cclxuICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vIHRlcm1pbmEgY2hlY2sgc2hvdyBlcnJvclxyXG4gIC8vIGlzIHZhbGlkXHJcblxyXG4gIGlzVmFsaWQoZm9ybUlEKSB7XHJcbiAgICBsZXQgdmFsaWQgPSBcIlwiO1xyXG4gICAgY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtSUQpO1xyXG4gICAgY29uc3QgaW5wdXRzTGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICBpbnB1dHNMaXN0LmV2ZXJ5KChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgICByZXR1cm4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgICB9KVxyXG4gICAgKSB7XHJcbiAgICAgIHZhbGlkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdmFsaWQ7XHJcbiAgfVxyXG5cclxuICAvLyB0b2dnbGVCdG5cclxuICB0b2dnbGVCdG5TdGF0ZShmb3JtSUQpIHtcclxuICAgIGNvbnN0IGZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZm9ybUlEKTtcclxuICAgIGNvbnN0IGJ0bkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICBpZiAodGhpcy5pc1ZhbGlkKGZvcm1JRCkgPT09IHRydWUpIHtcclxuICAgICAgYnRuRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYnRuRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9wcnVlYmEgZW5hYmxlIHZhbGlkYXRpb25cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLl9mb3JtU2VsZWN0b3IpO1xyXG5cclxuICAgIGNvbnN0IGlucHV0c0xpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy50b2dnbGVCdG5TdGF0ZSh0aGlzLl9mb3JtU2VsZWN0b3IpO1xyXG4gICAgaW5wdXRzTGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIHRoaXMuc3dpdGNoaW5nSW5wdXQoZXZ0KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ0blN0YXRlKHRoaXMuX2Zvcm1TZWxlY3Rvcik7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0ZXN0KCkge1xyXG4gICAgY29uc3QgZm9ybUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLl9mb3JtU2VsZWN0b3IpO1xyXG5cclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2V2dC50YXJnZXQuaWR9LWVycm9yYCk7XHJcbiAgICBjb25zb2xlLmxvZyhlcnJvckVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4vL3Rlcm1pbmEgb2JqZXRvXHJcbi8vICBwcnVlYmEgUGFyYSBQcm9maWxlIGZvcm1cclxuXHJcbi8vUHJveWVjdG8gOFxyXG4iLCJpbXBvcnQge1xyXG4gIHBvcHVwUGhvdG8sXHJcbiAgbGlua1BvcHVwLFxyXG4gIGNhcHRpb25Qb3B1cCxcclxuICBidG5DbG9zZVBob3RvLFxyXG59IGZyb20gXCIuLi91dGlscy9EYXRhLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkLWNvbnRhaW5lclwiKTtcclxuXHJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIHBob3RvSGFuZGxlciB9LCB0ZW1wbGF0ZVNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5wbGFjZU5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9waG90b0hhbmRsZXIgPSBwaG90b0hhbmRsZXI7XHJcbiAgfVxyXG4gIGdldFRlbXBsYXRlKCkge1xyXG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yKS5jb250ZW50O1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGVcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2UtY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2UtY2FyZF9fbmFtZVwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlLWNhcmRfX3Bob3RvXCIpLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGNvbnN0IHRyYXNoQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50cmFzaC1idXR0b25cIik7XHJcbiAgICB0cmFzaEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkVG9SZW1vdmUgPSB0cmFzaEJ0bi5jbG9zZXN0KFwiLnBsYWNlLWNhcmRcIik7XHJcbiAgICAgIGNhcmRUb1JlbW92ZS5yZW1vdmUoKTtcclxuICAgIH0pO1xyXG4gICAgY29uc3QgbGlrZUljb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmxpa2UtYnV0dG9uXCIpO1xyXG4gICAgbGlrZUljb24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwibGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZU9wZW5Qb3B1cCgpIHtcclxuICAgIHRoaXMuX3Bob3RvSGFuZGxlcih0aGlzLl9saW5rLCB0aGlzLl9uYW1lKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbG9zZVBvcHVwKCkge1xyXG4gICAgbGlua1BvcHVwLnNyYyA9IFwiIFwiO1xyXG4gICAgY2FwdGlvblBvcHVwLnRleHRDb250ZW50ID0gXCIgXCI7XHJcbiAgICBwb3B1cFBob3RvLmNsYXNzTGlzdC5yZW1vdmUoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5wbGFjZS1jYXJkX19waG90b1wiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVPcGVuUG9wdXAoKTtcclxuICAgICAgfSk7XHJcbiAgICBidG5DbG9zZVBob3RvLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNsb3NlUG9wdXAoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICB0ZXN0KCkge1xyXG4gICAgdGhpcy5nZW5lcmF0ZUNhcmQoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICB0aGlzLl9wb3B1cCA9IHBvcHVwO1xyXG4gICAgdGhpcy5fZm9ybSA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICB9XHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICB9XHJcbiAgX2hhbmRsZUVzY0Nsb3NlKCkge1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQ7XHJcbiAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMob3BlbkJ1dHRvbikge1xyXG4gICAgb3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLm9wZW4oKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm1cclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fY2xvc2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsIi8vIHBvcHVwIHdpdGggaW1hZ2VcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICBzdXBlcihwb3B1cCk7XHJcbiAgfVxyXG4gIG9wZW4oc3JjLCBuYW1lKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB0aGlzLl9waG90byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX3Bob3RvXCIpLnNyYyA9IHNyYztcclxuXHJcbiAgICB0aGlzLl9jYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIucG9wdXBfX3Bob3RvLWNhcHRpb25cIlxyXG4gICAgKS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgfVxyXG4gIHRlc3QoKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcImRlc2RlIHRlc3QgZGUgcG9waW1hZ2VcIik7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgZm9ybVN1Ym1pdEhhbmRsZXIgfSwgcG9wdXApIHtcclxuICAgIHN1cGVyKHBvcHVwKTtcclxuICAgIHRoaXMuX2Zvcm1TdWJtaXRIYW5kbGVyID0gZm9ybVN1Ym1pdEhhbmRsZXI7XHJcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgaWYgKHRoaXMuX2Zvcm0uaWQgPT0gXCJwbGFjZVwiKSB7XHJcbiAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICBldnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybV9faW5wdXRcIik7XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKG9wZW5CdXR0b24pIHtcclxuICAgIHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKG9wZW5CdXR0b24pO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBldnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHRoaXMuX2Zvcm1TdWJtaXRIYW5kbGVyKHRoaXMuZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgZG9jdW1lbnQuZm9ybXMucGxhY2UucmVzZXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyB1c2VyTmFtZSwgdXNlckFib3V0TWUgfSBmcm9tIFwiLi4vdXRpbHMvRGF0YS5qc1wiO1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB1c2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBkYXRhIH0pIHtcclxuICAgIHRoaXMuX3VzZXJOYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fdXNlckFib3V0TWUgPSBkYXRhW1wiYWJvdXQtbWVcIl07XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgdGhpcy5fdXNlck5hbWUgPSB1c2VyTmFtZS50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX3VzZXJBYm91dE1lID0gdXNlckFib3V0TWUudGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbygpIHtcclxuICAgIHVzZXJOYW1lLnRleHRDb250ZW50ID0gdGhpcy5fdXNlck5hbWU7XHJcbiAgICB1c2VyQWJvdXRNZS50ZXh0Q29udGVudCA9IHRoaXMuX3VzZXJBYm91dE1lO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL3N0eWxlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IHtcclxuICBidG5FZGl0UHJvZmlsZSxcclxuICBwb3B1cEVkaXRQcm9maWxlLFxyXG4gIGluaXRpYWxDYXJkcyxcclxuICBwb3B1cFBob3RvLFxyXG4gIHBvcHVwQWRkTmV3UGxhY2UsXHJcbiAgYnRuQWRkTmV3UGxhY2UsXHJcbiAgYnRuU3VibWl0TmV3UGxhY2UsXHJcbiAgdXNlckF2YXRhcixcclxuICB1c2VyTmFtZSxcclxuICB1c2VyQWJvdXRNZSxcclxufSBmcm9tIFwiLi9zY3JpcHQvdXRpbHMvRGF0YS5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi9zY3JpcHQvY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSBcIi4vc2NyaXB0L2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgeyBDYXJkLCBjYXJkc0NvbnRhaW5lciB9IGZyb20gXCIuL3NjcmlwdC9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuL3NjcmlwdC9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuL3NjcmlwdC9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IHVzZXJJbmZvIGZyb20gXCIuL3NjcmlwdC9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcblxyXG4vLyBvYmpldG9zIHBhcmEgdmFsaWRhclxyXG5jb25zdCB2YWxpZGF0aW9uT2JqZWN0ID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCJwcm9maWxlXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcclxufTtcclxuXHJcbmNvbnN0IHZhbGlkYXRpb25PYmplY3QyID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCJwbGFjZVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcImZvcm1fX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcbi8vbGxhbWFuZG8gYSBGb3JtVmFsaWRhdG9yXHJcbmNvbnN0IFByb2ZpbGVWYWxpZGF0aW9uID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvbk9iamVjdCk7XHJcbmNvbnN0IHRlc3QgPSBQcm9maWxlVmFsaWRhdGlvbi5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbi8vcHJ1ZWJhIHBhcmEgcGxhY2UgZm9ybVxyXG5jb25zdCBQbGFjZVZhbGlkYXRpb24gPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uT2JqZWN0Mik7XHJcbmNvbnN0IHRlc3QyID0gUGxhY2VWYWxpZGF0aW9uLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vIFBvcnllY3RvIDlcclxuXHJcbmNvbnN0IGRlZmF1bHRDYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGRhdGE6IGl0ZW0sXHJcbiAgICAgICAgICBwaG90b0hhbmRsZXI6IChzcmMsIG5hbWUpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGhvdG8gPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBQaG90byk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1Bob3RvID0gcGhvdG8ub3BlbihzcmMsIG5hbWUpO1xyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIlxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBuZXdDYXJkID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICAgICAgZGVmYXVsdENhcmRMaXN0LmFkZEl0ZW0obmV3Q2FyZCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgY2FyZHNDb250YWluZXJcclxuKTtcclxuZGVmYXVsdENhcmRMaXN0LnJlbmRlckl0ZW1zKCk7XHJcblxyXG4vL3BvcHVwIGZvcm0gcHJvZmlsZVxyXG5jb25zdCBmb3JtUG9wdXBQcm9maWxlID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAge1xyXG4gICAgZm9ybVN1Ym1pdEhhbmRsZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgIC8vIGFxdWkgZW1waWV6YSBjYWxsYmFja1xyXG5cclxuICAgICAgY29uc3QgdXNlciA9IG5ldyB1c2VySW5mbyh7IGRhdGE6IGRhdGEgfSk7XHJcbiAgICAgIGNvbnN0IG5ld1VzZXIgPSB1c2VyLnNldFVzZXJJbmZvKCk7XHJcbiAgICAgIGNvbnN0IHJlc2V0VXNlciA9IHVzZXIuZ2V0VXNlckluZm8oKTtcclxuICAgIH0sIC8vYXF1aSB0ZXJtaW5ja1xyXG4gIH0sXHJcbiAgcG9wdXBFZGl0UHJvZmlsZVxyXG4pO1xyXG5jb25zdCBuZXdGb3JtUG9wdXAgPSBmb3JtUG9wdXBQcm9maWxlLnNldEV2ZW50TGlzdGVuZXJzKGJ0bkVkaXRQcm9maWxlKTtcclxuXHJcbi8vICBwb3B1cCBmb3JtIHBsYWNlXHJcbmNvbnN0IGZvcm1Qb3B1cFBsYWNlID0gbmV3IFBvcHVwV2l0aEZvcm0oIC8vIGRlY2xhcmFuZG8gZm9ybVxyXG4gIHtcclxuICAgIGZvcm1TdWJtaXRIYW5kbGVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBuZXdJdGVtID0gZGF0YTtcclxuXHJcbiAgICAgIGNvbnN0IGFkZGVkQ2FyZExpc3QgPSBbXTtcclxuXHJcbiAgICAgIGFkZGVkQ2FyZExpc3QucHVzaChuZXdJdGVtKTtcclxuICAgICAgYnRuU3VibWl0TmV3UGxhY2UuY2xhc3NMaXN0LmFkZChcImZvcm1fX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIik7XHJcbiAgICAgIGNvbnN0IGlucHV0U2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGl0ZW1zOiBhZGRlZENhcmRMaXN0LFxyXG4gICAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlucHV0Q2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgICAgICBwaG90b0hhbmRsZXI6IChzcmMsIG5hbWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgY29uc3QgcGhvdG8gPSBuZXcgUG9wdXBXaXRoSW1hZ2UocG9wdXBQaG90byk7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1Bob3RvID0gcGhvdG8ub3BlbihzcmMsIG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdDYXJkID0gaW5wdXRDYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICBpbnB1dFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjYXJkc0NvbnRhaW5lclxyXG4gICAgICApO1xyXG4gICAgICBpbnB1dFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBwb3B1cEFkZE5ld1BsYWNlXHJcbik7XHJcbmZvcm1Qb3B1cFBsYWNlLnNldEV2ZW50TGlzdGVuZXJzKGJ0bkFkZE5ld1BsYWNlLCBcIi5mb3JtX19zdWJtaXQtYnV0dG9uX3BsYWNlXCIpOyAvLyBzZSBhY2Npb25hICBwb3B1b3Agd2l0aCBmb3JtXHJcblxyXG4vL1Byb3llY3RvIDEwXHJcbi8vcmVuZGVyUHJvZmlsZVxyXG5mdW5jdGlvbiByZW5kZXJSZXN1bHRzKHVzZXJEYXRhKSB7XHJcbiAgdXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gIHVzZXJBYm91dE1lLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgdXNlckF2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbn1cclxuXHJcbmZldGNoKFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfMDcvdXNlcnMvbWUgXCIsIHtcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImQ3M2ZmOGE0LTVhZDctNDJjYi05OTljLWQwODRjYTJlNjg0N1wiLFxyXG4gIH0sXHJcbn0pXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZXMuc3RhdHVzKTtcclxuICB9KVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHJlbmRlclJlc3VsdHMocmVzKTtcclxuICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgfSlcclxuICAudGhlbigocmVzKSA9PiB7XHJcbiAgICB1c2VyTmFtZS50ZXh0Q29udGVudCA9IHJlcy5uYW1lO1xyXG4gICAgdXNlckFib3V0TWUudGV4dENvbnRlbnQgPSByZXMuYWJvdXQ7XHJcbiAgICB1c2VyQXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgfSk7XHJcbi8vY2FyZ2FyIENhcmRzXHJcbiJdLCJuYW1lcyI6WyJmZXRjaCIsImhlYWRlcnMiLCJhdXRob3JpemF0aW9uIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjb25zb2xlIiwibG9nIiwiYnRuRWRpdFByb2ZpbGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwb3B1cEVkaXRQcm9maWxlIiwidXNlck5hbWUiLCJ1c2VyQWJvdXRNZSIsInVzZXJBdmF0YXIiLCJidG5BZGROZXdQbGFjZSIsInBvcHVwQWRkTmV3UGxhY2UiLCJidG5TdWJtaXROZXdQbGFjZSIsInBvcHVwUGhvdG8iLCJsaW5rUG9wdXAiLCJjYXB0aW9uUG9wdXAiLCJidG5DbG9zZVBob3RvIiwiU2VjdGlvbiIsImNvbnN0cnVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsImNvbnRhaW5lclNlbGVjdG9yIiwidGhpcyIsIl9pdGVtc0FycmF5IiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJpdGVtIiwiYXBwZW5kIiwicmVuZGVySXRlbXMiLCJmb3JFYWNoIiwidGVzdCIsInJlZ0V4IiwiRm9ybVZhbGlkYXRvciIsIm9ialRvVmFsaWRhdGUiLCJfZm9ybVNlbGVjdG9yIiwiZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwic3dpdGNoaW5nSW5wdXQiLCJldnQiLCJ0YXJnZXQiLCJuYW1lIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImV4cHJlc2lvbiIsImlucHV0RWxlbWVudCIsImZvcm1JRCIsImVycm9yRWxlbWVudCIsImdldEVsZW1lbnRCeUlkIiwiaWQiLCJ2YWx1ZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJhZGQiLCJpc1ZhbGlkIiwidmFsaWQiLCJmb3JtRWxlbWVudCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJldmVyeSIsInZhbGlkaXR5IiwidG9nZ2xlQnRuU3RhdGUiLCJidG5FbGVtZW50IiwiZW5hYmxlVmFsaWRhdGlvbiIsImlucHV0c0xpc3QiLCJpbnB1dCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjYXJkc0NvbnRhaW5lciIsIkNhcmQiLCJkYXRhIiwicGhvdG9IYW5kbGVyIiwidGVtcGxhdGVTZWxlY3RvciIsIl9uYW1lIiwicGxhY2VOYW1lIiwiX2xpbmsiLCJsaW5rIiwiX3RlbXBsYXRlU2VsZWN0b3IiLCJfcGhvdG9IYW5kbGVyIiwiZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiX2NhcmRFbGVtZW50Iiwic3JjIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwidHJhc2hCdG4iLCJjbG9zZXN0IiwidG9nZ2xlIiwiX2hhbmRsZU9wZW5Qb3B1cCIsIl9oYW5kbGVDbG9zZVBvcHVwIiwiUG9wdXAiLCJwb3B1cCIsIl9wb3B1cCIsIl9mb3JtIiwib3BlbiIsImNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwicHJldmVudERlZmF1bHQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsIm9wZW5CdXR0b24iLCJQb3B1cFdpdGhJbWFnZSIsInN1cGVyIiwiX3Bob3RvIiwiX2NhcHRpb24iLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVN1Ym1pdEhhbmRsZXIiLCJfZm9ybVN1Ym1pdEhhbmRsZXIiLCJyZXNldCIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsImdldElucHV0VmFsdWVzIiwiX2lucHV0TGlzdCIsImZvcm1WYWx1ZXMiLCJmb3JtcyIsInBsYWNlIiwidXNlckluZm8iLCJfdXNlck5hbWUiLCJfdXNlckFib3V0TWUiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiZGVmYXVsdENhcmRMaXN0IiwibmV3Q2FyZCIsInVzZXIiLCJuZXdJdGVtIiwiYWRkZWRDYXJkTGlzdCIsInB1c2giLCJpbnB1dFNlY3Rpb24iLCJ1c2VyRGF0YSIsImFib3V0IiwiYXZhdGFyIiwiY2F0Y2giLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=